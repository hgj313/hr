# 园林景观施工公司人力资源调度系统需求分析

## 项目概述

本系统是为园林景观施工公司设计的人力资源调度管理系统，旨在解决多项目、多区域、多时间段的人员调配问题，提供直观的可视化界面和智能的调度算法。

## 核心功能需求

### 1. 区域选择组件
- **功能描述**：支持多个地理区域的筛选和管理
- **支持区域**：
  - 全国分布
  - 华东
  - 华南
  - 西南
  - 华中
- **业务价值**：便于按地理位置管理分布式项目和人力资源

### 2. 双层时间选择系统
- **主时间选择器（项目时间选择器）**
  - 用途：选择项目的时间范围
  - 功能：筛选特定时间段内的项目
- **副时间选择器（人力资源时间选择器）**
  - 用途：选择人力资源的可用时间范围
  - 功能：筛选特定时间段内可用的人员
- **设计亮点**：两个时间选择器独立操作，解决项目时间与人员可用时间不同步的现实问题

### 3. 拖拽分配系统
- **核心交互**：
  - 人员从资源池拖拽到项目池进行分配
  - 支持反向操作（从项目中移除人员）
- **派遣时长设置**：拖拽分配时可设置具体的派遣时长
- **员工时间轴属性**：每个员工拥有独立的时间轴，记录：
  - 可用时间段
  - 已分配时间段
  - 时间冲突检测

### 4. 项目详情页面
- **进入方式**：点击项目卡片进入详情页面
- **时间轴视图**：显示项目的完整时间轴
- **员工卡片智能排布逻辑**：
  - **横向位置**：完全由员工个人的时间轴决定（实际工作时间段）
  - **竖向排序**：仅在多个员工时间轴发生冲突/重叠时启动
  - **排序依据**：按照派遣的先后顺序排列（先派遣的排在上方）
- **动态布局调整**：系统自动根据时间冲突情况调整员工卡片的垂直位置

### 5. 通知系统
- **触发条件**：员工派遣即将结束前（可设置提前通知时间）
- **通知对象**：
  - 项目负责人
  - HR管理员
  - 被派遣员工
- **通知内容**：派遣即将结束的提醒，便于提前安排后续工作

## 核心算法：员工卡片排布算法

### 算法示例
**输入数据**：
- 张三(1-5日)
- 李四(2-7日)
- 王五(3-8日)
- 小李(9-12日)
- 小王(14-17日)

### 时间冲突分析
1. **张三(1-5日)** 与 **李四(2-7日)** 冲突（2-5日重叠）
2. **李四(2-7日)** 与 **王五(3-8日)** 冲突（3-7日重叠）
3. **小李(9-12日)** 和 **小王(14-17日)** 无冲突

### 排布结果
```
时间轴：  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17
第一行：  [张三1-5日]                    [小李9-12日]    [小王14-17日]
第二行：     [李四2-7日]
第三行：        [王五3-8日]
```

### 算法逻辑
1. **横向定位**：根据员工实际工作时间段确定横向位置
2. **冲突检测**：检测时间轴重叠情况
3. **竖向排序**：按派遣先后顺序分配行数
4. **空间复用**：无冲突的员工可复用同一行

## 技术架构设计

### 前端技术栈
- **框架**：React + TypeScript
- **UI组件库**：Ant Design
- **拖拽库**：@dnd-kit 或 react-beautiful-dnd
- **时间轴可视化**：自定义组件
- **状态管理**：Redux Toolkit 或 Zustand

### 后端技术栈
- **框架**：Node.js + Express 或 Python + FastAPI
- **数据库**：PostgreSQL（支持复杂查询）
- **缓存**：Redis
- **定时任务**：node-cron 或 Celery

### 数据库设计要点
- **员工表**：基本信息、技能、可用时间
- **项目表**：项目信息、时间范围、所需技能
- **分配表**：员工-项目分配关系、派遣时间
- **通知表**：通知记录、状态跟踪

## 技术挑战与解决方案

### 1. 复杂时间轴布局算法
- **挑战**：多员工时间重叠的动态排布
- **解决方案**：
  - 实现区间重叠检测算法
  - 动态计算最优行数分配
  - 支持实时布局调整

### 2. 实时拖拽交互
- **挑战**：流畅的用户体验和数据同步
- **解决方案**：
  - 使用成熟的拖拽库
  - 实现乐观更新机制
  - 添加拖拽预览和反馈

### 3. 通知系统
- **挑战**：定时任务和多角色通知
- **解决方案**：
  - 实现可配置的定时任务
  - 支持多种通知渠道
  - 通知状态跟踪和重试机制

## 开发优先级

### 高优先级
1. 基础项目架构搭建
2. 核心数据模型设计
3. 时间轴布局算法实现
4. 拖拽分配功能

### 中优先级
1. 区域选择组件
2. 双时间选择器
3. 项目详情页面
4. 基础通知功能

### 低优先级
1. 高级通知配置
2. 数据导出功能
3. 报表统计
4. 系统优化

## 预期效果

1. **提升调度效率**：可视化界面大幅提升人员调配效率
2. **减少冲突**：智能算法自动检测和处理时间冲突
3. **增强协作**：多角色通知系统确保信息及时传达
4. **数据驱动**：完整的调度记录支持数据分析和优化

## 总结

本系统通过创新的双时间选择器设计、智能的时间轴布局算法和直观的拖拽交互，为园林景观施工公司提供了一套完整的人力资源调度解决方案。系统既解决了复杂的业务需求，又保证了良好的用户体验。